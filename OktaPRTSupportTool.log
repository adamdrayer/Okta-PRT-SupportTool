.
[2023-01-17 01:35:02.754] [INFO] ===========================================================
[2023-01-17 01:35:02.754] [INFO]                    Okta PRT Support Tool                   
[2023-01-17 01:35:02.770] [INFO] ===========================================================
[2023-01-17 01:35:02.770] [INFO] Authored by Adam Drayer, adam.drayer@okta.com
[2023-01-17 01:35:02.770] [INFO]  
[2023-01-17 01:35:02.785] [INFO] Okta PRT Support Tool v0.8 has started
[2023-01-17 01:35:02.785] [INFO]  
[2023-01-17 01:35:02.785] [INFO] Setting Global Variables...
[2023-01-17 01:35:07.181] [INFO]  
[2023-01-17 01:35:07.197] [INFO]  
[2023-01-17 01:35:07.197] [INFO] Device Name          : DESKTOP-7FU5V3V
[2023-01-17 01:35:07.197] [INFO] Windows Version      : 10.0.19045.0 (Supported)
[2023-01-17 01:35:07.213] [INFO] OS Edition           : Microsoft Windows 10 Pro (Supported)
[2023-01-17 01:35:07.230] [INFO] User Account         : adamdrayer
[2023-01-17 01:35:07.230] [INFO] User Principal Name  : adrayer@platformscholar.com
[2023-01-17 01:35:07.230] [INFO] Domain Joined?       : False
[2023-01-17 01:35:07.245] [INFO] Domain Name          : n/a
[2023-01-17 01:35:07.245] [INFO]  
[2023-01-17 01:35:07.245] [INFO] Starting Check of Configuration Settings...
[2023-01-17 01:35:07.261] [INFO]  
[2023-01-17 01:35:07.261] [INFO] Step 1 of 3 - Checking Local Device Settings...
[2023-01-17 01:35:07.261] [INFO] ===============================================
[2023-01-17 01:35:07.276] [INFO]  
[2023-01-17 01:35:07.276] [INFO] Checking for Active PRT...
[2023-01-17 01:35:07.292] [INFO] DSRegCmd is reporting an active PRT!
[2023-01-17 01:35:07.292] [INFO] PRT Timestampe is: 1/16/2023 11:17:09 AM UTC
[2023-01-17 01:35:07.292] [INFO] Current Session Logon Time is: 1/16/2023 11:17:00 AM UTC
[2023-01-17 01:35:07.308] [INFO]  
[2023-01-17 01:35:07.308] [INFO] Checking for Azure Device Join Status...
[2023-01-17 01:35:07.308] [INFO] Azure AD Joined?      : True
[2023-01-17 01:35:07.323] [INFO] Azure AD Registered?  : True
[2023-01-17 01:35:07.323] [INFO] Device is Reporting as: AzureAD-Joined + AzureAD-Registered
[2023-01-17 01:35:07.339] [INFO]  
[2023-01-17 01:35:07.339] [INFO] Checking for Azure Tenant ID Settings...
[2023-01-17 01:35:07.355] [INFO] TenantId is    : d71ed0e1-ee52-4899-8676-67763b18fc88
[2023-01-17 01:35:07.355] [INFO] TenantName is  : Platform Scholar
[2023-01-17 01:35:07.355] [INFO]  
[2023-01-17 01:35:07.370] [INFO] Checking for Azure AD Join Date & Time...
[2023-01-17 01:35:07.685] [INFO] Windows Event found for Device Join to Azure AD.  DateTime: 09/20/2022 16:24:41
[2023-01-17 01:35:07.701] [INFO]  
[2023-01-17 01:35:07.701] [INFO]  
[2023-01-17 01:35:07.701] [INFO] Step 2 of 3 - Checking Azure AD Settings...
[2023-01-17 01:35:07.717] [INFO] ===============================================
[2023-01-17 01:35:07.717] [INFO]  
[2023-01-17 01:35:07.732] [INFO] Testing Internet Connection to Azure AD
[2023-01-17 01:35:08.033] [INFO] Azure AD Tenant Reachable - Internet OK
[2023-01-17 01:35:08.033] [INFO]  
[2023-01-17 01:35:08.048] [INFO] Checking if there is an existing valid Azure AD Access Token for this Powershell session...
[2023-01-17 01:35:08.441] [INFO] There is a valid Access Token for user: Adam Drayer (Platformscholar), UPN: adrayer@platformscholar.com
[2023-01-17 01:35:08.456] [INFO]  
[2023-01-17 01:35:08.456] [INFO] Checking DSREGCMD /STATUS for DeviceId...
[2023-01-17 01:35:08.472] [INFO] Device ID: 78276970-314a-40d2-8e72-75fd447eeeac
[2023-01-17 01:35:08.472] [INFO]  
[2023-01-17 01:35:08.741] [INFO] Testing device status on Azure AD...
[2023-01-17 01:35:08.741] [INFO]  
[2023-01-17 01:35:08.757] [INFO] Testing if device exists on Azure AD...
[2023-01-17 01:35:08.773] [INFO] Test passed: the device object exists on Azure AD
[2023-01-17 01:35:08.773] [INFO]  
[2023-01-17 01:35:08.773] [INFO] Testing if device is enabled on Azure AD...
[2023-01-17 01:35:08.788] [INFO] Test passed: the device is enabled on Azure AD tenant
[2023-01-17 01:35:08.788] [INFO]  
[2023-01-17 01:35:08.788] [INFO] Testing device Join state...
[2023-01-17 01:35:08.804] [INFO] The device is reporting as AAD-Joined Only (TrustType = AzureAd)
[2023-01-17 01:35:08.804] [INFO]  
[2023-01-17 01:35:08.804] [INFO] Testing device PENDING state...
[2023-01-17 01:35:08.819] [INFO] Test passed: the device is not in PENDING state
[2023-01-17 01:35:08.819] [INFO]  
[2023-01-17 01:35:08.819] [INFO] Checking if device is stale...
[2023-01-17 01:35:08.835] [INFO] Device is not stale
[2023-01-17 01:35:08.835] [INFO]  
[2023-01-17 01:35:08.835] [INFO] Last logon timestamp: 2023-01-07T13:18:41Z UTC, 9 days ago
[2023-01-17 01:35:08.851] [INFO]  
[2023-01-17 01:35:08.851] [INFO] Attempting to query Azure AD Federation settings for user: adrayer@platformscholar.com
[2023-01-17 01:35:08.982] [INFO] Azure AD User Info found for current user adrayer@platformscholar.com
[2023-01-17 01:35:08.982] [INFO]  
[2023-01-17 01:35:08.998] [INFO] User Object ID    : dccbbc66-835e-444a-a909-f79a41b1fc04
[2023-01-17 01:35:09.012] [INFO] UserPrincipalName : adrayer@platformscholar.com
[2023-01-17 01:35:09.012] [INFO] DisplayName       : Adam Drayer (Platformscholar)
[2023-01-17 01:35:09.012] [INFO] Account Enabled   : True
[2023-01-17 01:35:09.027] [INFO] ImmutableId       : 0ua2q7l5f8W8wRvcN697
[2023-01-17 01:35:09.027] [INFO]  
[2023-01-17 01:35:09.043] [INFO] Attempting to query Azure AD Federation settings for user: adrayer@platformscholar.com
[2023-01-17 01:35:09.376] [INFO] Azure AD Federation Settings found for current user adrayer@platformscholar.com
[2023-01-17 01:35:09.376] [INFO]  
[2023-01-17 01:35:09.391] [INFO] Account Type              : Federated
[2023-01-17 01:35:09.391] [INFO] Domain Name               : platformscholar.com
[2023-01-17 01:35:09.407] [INFO] Federation Protocol       : WSTrust
[2023-01-17 01:35:09.407] [INFO] Federation Metadata URL   : https://drayer.okta.com/app/office365/exk2q6pnf0XnclRDs697/sso/wsfed/mex
[2023-01-17 01:35:09.407] [INFO] Federation Active Auth URL: https://drayer.okta.com/app/office365/exk2q6pnf0XnclRDs697/sso/wsfed/active
[2023-01-17 01:35:09.422] [INFO]  
[2023-01-17 01:35:09.422] [INFO] Checking to see if Azure Federation URL is an Okta Tenant...
[2023-01-17 01:35:09.438] [INFO] Azure Federation Partner URL is Okta.com!
[2023-01-17 01:35:09.438] [INFO]  
[2023-01-17 01:35:09.454] [INFO] Step 3 of 3 - Checking Okta Settings...
[2023-01-17 01:35:09.454] [INFO] ===============================================
[2023-01-17 01:35:09.454] [INFO]  
[2023-01-17 01:35:09.469] [INFO] Checking to see if there is an API Token set...
[2023-01-17 01:35:09.469] [INFO] Okta API Token Found, asdfa... - Continuing
[2023-01-17 01:35:09.485] [INFO]  
[2023-01-17 01:35:09.485] [INFO] Determining Okta Tenant Info
[2023-01-17 01:35:09.485] [INFO] Okta Base Tenant URL  : https://drayer.okta.com
[2023-01-17 01:35:09.501] [INFO] Okta Tenant Subdomain : drayer 
[2023-01-17 01:35:09.501] [INFO]  
[2023-01-17 01:35:09.816] [INFO] Unable to connect to Okta API Endpoint for tenant https://drayer.okta.com with provided API token.
[2023-01-17 01:35:09.816] [INFO] Please specify tenant URL (i.e., https://xxx.okta.com): 
[2023-01-17 01:35:21.390] [INFO] Please input API Token (or press Enter to keep existing -> 'asdfa...'): 
[2023-01-17 01:35:35.110] [INFO] Tenant set to https://drayer.okta.com
[2023-01-17 01:35:35.351] [INFO] API Token is valid for given tenant https://drayer.okta.com
[2023-01-17 01:35:35.351] [INFO]  
[2023-01-17 01:35:35.367] [INFO]  
[2023-01-17 01:35:35.367] [INFO] Getting Office 365 App Data for domain: platformscholar.com
[2023-01-17 01:35:35.760] [INFO] No Active Office365 App Found for domain: platformscholar.com
[2023-01-17 01:35:35.839] [INFO] Error - Unable to find App in Okta for domain: platformscholar.com....
[2023-01-17 01:35:35.854] [INFO]  
[2023-01-17 01:35:35.854] [INFO] Looking to see if UPN 'adrayer@platformscholar.com' is assigned to Office 365 App Instance: ''...
[2023-01-17 01:35:35.967] [INFO] The remote server returned an error: (404) Not Found..Exception.Message
[2023-01-17 01:35:35.967] [INFO] ERROR! - Unable to locate Okta user for Office 365 app!
[2023-01-17 01:35:35.983] [INFO]  
[2023-01-17 01:35:35.983] [INFO] Looking to see if samAccountName 'adamdrayer' is assigned to Office 365 App Instance: ''...
[2023-01-17 01:35:36.082] [INFO] The remote server returned an error: (404) Not Found..Exception.Message
[2023-01-17 01:35:36.082] [INFO] ERROR! - Unable to locate Okta user for Office 365 app!
[2023-01-17 01:35:36.098] [INFO]  
[2023-01-17 01:35:36.098] [INFO] Could not find user by Office 365 Username, Looking for Okta User by UPN
[2023-01-17 01:35:36.290] [INFO] Okta User Found by UPN: adrayer@platformscholar.com
[2023-01-17 01:35:36.290] [INFO]  
[2023-01-17 01:35:36.306] [INFO] Checking to see if User is assigned Office 365 App Instance ID: ...
[2023-01-17 01:35:36.387] [INFO] The remote server returned an error: (405) Method Not Allowed..Exception.Message
[2023-01-17 01:35:36.630] [INFO] Okta User Id:  not assigned Office 365 App Instance 
[2023-01-17 01:35:36.645] [INFO]  
[2023-01-17 01:35:36.645] [INFO] Unable to Locate Office 365 App Data for user adrayer@platformscholar.com on App Instance Id: ...
[2023-01-17 01:35:36.645] [INFO]  
[2023-01-17 01:35:36.661] [INFO] Checking Okta System Log for PRT Events for current user...
[2023-01-17 01:35:36.661] [INFO] PRT Events NOT found for user
[2023-01-17 01:35:36.672] [INFO]  
[2023-01-17 01:35:36.675] [INFO] Processing Checklist....
[2023-01-17 01:35:36.675] [INFO] ===============================================
[2023-01-17 01:35:36.675] [INFO]  
[2023-01-17 01:35:36.691] [INFO] Check #1 - Device Join Type is Azure-Joined or Hybrid-Joined                       : 'AzureAD-Joined + AzureAD-Registered'...
[2023-01-17 01:35:36.691] [INFO] PASSED!
[2023-01-17 01:35:36.691] [INFO] Check #2 - UPN Retrieved from Domain (Hybrid) or device                            : 'adrayer@platformscholar.com'...
[2023-01-17 01:35:36.707] [INFO] PASSED!
[2023-01-17 01:35:36.707] [INFO] Check #3 - Check Azure AD Tenant Settings, Tenant ID                               : 'd71ed0e1-ee52-4899-8676-67763b18fc88'...
[2023-01-17 01:35:36.707] [INFO] PASSED!
[2023-01-17 01:35:36.722] [INFO] Check #4 - Device Exists in Azure,  Device Id                                      : '78276970-314a-40d2-8e72-75fd447eeeac'...
[2023-01-17 01:35:36.722] [INFO] PASSED!
[2023-01-17 01:35:36.722] [INFO] Check #5 - Azure Device Join Type is Azure-Joined or Hybrid-Joined                 : 'AzureAd'...
[2023-01-17 01:35:36.738] [INFO] PASSED!
[2023-01-17 01:35:36.738] [INFO] Check #6 - AzureAD-Join/Hybrid Timestamp is before current Windows Login Timestamp : '09/20/2022 16:24:41' UTC...
[2023-01-17 01:35:36.738] [INFO] PASSED!
[2023-01-17 01:35:36.753] [INFO] Check #7 - UserPrincipalName from Device exists in Azure as user                   : 'adrayer@platformscholar.com'...
[2023-01-17 01:35:36.753] [INFO] PASSED!
[2023-01-17 01:35:36.753] [INFO] Check #8 - User is Active in Azure (Login not blocked or disabled)                 : 'True'...
[2023-01-17 01:35:36.769] [INFO] PASSED!
[2023-01-17 01:35:36.769] [INFO] Check #9 - UPN Domain Suffix is a Federated Domain in Azure                       : 'platformscholar.com:Federated'...
[2023-01-17 01:35:36.769] [INFO] PASSED!
[2023-01-17 01:35:36.785] [INFO] Check #10 - Okta is the Azure Federation Partner for the UPN Domain Suffix         : 'https://drayer.okta.com/app/office365/exk2q6pnf0XnclRDs697/sso/wsfed/active'...
[2023-01-17 01:35:36.785] [INFO] PASSED!
[2023-01-17 01:35:36.785] [INFO] Check #11 - An Office 365 App exists in Okta that is federated for the UPN Domain  : ''...
[2023-01-17 01:35:36.785] [INFO] FAILED!
[2023-01-17 01:35:36.800] [INFO] Check #12 - The discovered Office 365 App has an ACTIVE status                     : ''...
[2023-01-17 01:35:36.800] [INFO] FAILED!
[2023-01-17 01:35:36.800] [INFO] Check #13 - UPN was successfully found in lookup against Office 365 App Usernames  : ''...
[2023-01-17 01:35:36.816] [INFO] FAILED!
[2023-01-17 01:35:36.816] [INFO] Check #14 - User has ImmutableId value in Azure                                     : '0ua2q7l5f8W8wRvcN697'...
[2023-01-17 01:35:36.816] [INFO] PASSED!
[2023-01-17 01:35:36.832] [INFO] Check #15 - User's ImmutableId in App User Profile matches Azure user profile      : ''...
[2023-01-17 01:35:36.832] [INFO] FAILED!
[2023-01-17 01:35:36.832] [INFO] Check #16 - An authentication policy was triggered during most recent Win login    : '' UTC...
[2023-01-17 01:35:36.847] [INFO] MISSING
[2023-01-17 01:35:36.847] [INFO] Check #17 - Authentication Policy allowed basic auth for Windows Login event       : ''...
[2023-01-17 01:35:36.847] [INFO] MISSING
[2023-01-17 01:35:36.863] [INFO]  
[2023-01-17 01:35:36.863] [INFO]  
[2023-01-17 01:35:36.863] [INFO] Analyizing Results....
[2023-01-17 01:35:36.878] [INFO] ===============================================
[2023-01-17 01:35:36.878] [INFO]  
[2023-01-17 01:35:36.878] [INFO] (#11) Unable to locate an Office 365 App in Okta that is federated with Azure for the Domain in the UPN. Value: 'platformscholar.com'
[2023-01-17 01:35:36.894] [INFO] (#12) The Okta Office 365 App must be active and working properly. Value: ''
[2023-01-17 01:35:36.894] [INFO] (#13) No assigned user for the Office 365 App has an app username that matches the UPN. Value: ''
[2023-01-17 01:35:36.910] [INFO] (#15) The ImmutableId in the Okta user's Office 365 app profile must match the value in Azure. Value: ''
[2023-01-17 01:35:36.910] [INFO] (#16) A System Log entry was not found in Okta matching this logon attempt.  If any of the checks 1-14 failed, this is expected.  This also is true if Windows Hello for Business was used to login.
[2023-01-17 01:35:36.925] [INFO] (#17) No Authentication Policy was evaluated during the current Windows Login event.  If #16 failed, this is expected.
[2023-01-17 01:35:36.925] [INFO]  
[2023-01-17 01:35:36.941] [INFO]  
[2023-01-17 01:35:36.941] [INFO] Notes about results....
[2023-01-17 01:35:36.941] [INFO] ===============================================
[2023-01-17 01:35:36.957] [INFO]  
[2023-01-17 01:35:36.957] [INFO] Checks #1-13 - If there are any failures, Okta will not receive an authentication request for PRT
[2023-01-17 01:35:36.972] [INFO] Checks #14-15 - If these fail, Okta will not send the proper response to Azure for PRT requests
[2023-01-17 01:35:36.972] [INFO] Check #16-17 - These will be missing if Okta did not receive an authentication request for PRT (Checks #1-13)
[2023-01-17 01:35:36.972] [INFO]  
[2023-01-17 01:35:36.988] [INFO]  
